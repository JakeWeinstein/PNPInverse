\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{setspace}
\setlength{\parindent}{0pt}
\sisetup{round-mode=places,round-precision=4}
\title{Forward Solver D-Stability Study}
\author{Automated Benchmark Report}
\date{\today}
\begin{document}
\onehalfspacing
\maketitle

\section*{What We Ran}
\paragraph{Goal}\quad\\
This study maps where the forward PNP solve converges or fails as $(D_0,D_1)$ varies.

\paragraph{Setup}\quad\\
Study mode: Anisotropy-dense grid. Grid points: 1465. Coarse global grid with dense sampling concentrated where max(D0,D1)/min(D0,D1) >= 8. Composition: global\_coarse=324, lbfgsb\_focus=196, anis\_lowD0\_highD1=380, anis\_highD0\_lowD1=67, anis\_extreme\_lowD0\_highD1=287, anis\_extreme\_highD0\_lowD1=211. Non-$D$ parameters match the inverse studies: $n_{\mathrm{species}}=2$, $dt=0.02$, $t_{\mathrm{end}}=0.1$, $z=[1,-1]$, $a=[0,0]$, $c_0=[0.1,0.1]$, $\phi_0=1.0$, SNES newtonls + LU/MUMPS.

\vspace{1em}
\hrule
\vspace{1em}
\paragraph{How to read the map}\quad\\
Colored cells are converged solves with color = wall time (seconds, lower is better); red x marks failed solves. The dashed diagonal marks $D_0 = D_1$.
\section*{Summary Metrics}
\begin{table}[H]
\centering
\begin{tabular}{lr}
\toprule
Metric & Value \\
\midrule
Total $(D_0,D_1)$ points & 1465 \\
Converged points & 830 \\
Failed points & 635 \\
Success rate & 56.655\% \\
Median converged solve time (s) & 1.0117 \\
Failure reasons & DIVERGED\_LINE\_SEARCH: 428, DIVERGED\_MAX\_IT: 207 \\
\bottomrule
\end{tabular}
\end{table}

\section*{D-Stability Map}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{forward_solver_d_stability_map.png}
\caption{Forward-solver behavior in $(D_0,D_1)$ space. Dashed line marks $D_0 = D_1$. Converged time is lower-is-better.}
\end{figure}

\section*{Failure Pattern Summary}
Failures span $D_0\in[0.01,3]$ and $D_1\in[0.2,3.5]$, but cluster most strongly in low-and-imbalanced diffusion regimes.
Median $\min(D_0,D_1)$ is 0.06186 for failed points vs 0.2 for converged points; median anisotropy $\max/\min$ is 39.46 vs 8.813.
\begin{table}[H]
\centering
\small
\begin{tabular}{lrr}
\toprule
Region & Failures / Points & Failure Rate (\%) \\
\midrule
LBFGS-B focus: $D_0\in[0.02,0.35], D_1\in[0.3,1.3]$ & 14 / 321 & 4.361 \\
High anisotropy: $\max(D_0,D_1)/\min(D_0,D_1)\ge 10$ & 612 / 948 & 64.56 \\
Extreme corner: $\min(D)\le 0.1$, $\max(D)\ge 2.5$ & 216 / 244 & 88.52 \\
Low-$D_0$/high-$D_1$: $D_0\le 0.1$, $D_1\ge 1.3$ & 408 / 517 & 78.92 \\
High-$D_0$/low-$D_1$: $D_0\ge 1.0$, $D_1\le 0.35$ & 119 / 293 & 40.61 \\
\bottomrule
\end{tabular}
\end{table}
\section*{Representative Failed Points}
\begin{table}[H]
\centering
\small
\begin{tabular}{rrrl}
\toprule
$D_0$ & $D_1$ & Time (s) & Failure reason \\
\midrule
0.01 & 0.5492 & 0.9255 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1 & 0.9592 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.061 & 1.005 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.077 & 1.514 & DIVERGED\_MAX\_IT \\
0.01 & 1.127 & 0.9722 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.196 & 1.039 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.269 & 1.307 & DIVERGED\_MAX\_IT \\
0.01 & 1.275 & 0.9961 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.348 & 1.107 & DIVERGED\_LINE\_SEARCH \\
0.01 & 1.43 & 1.293 & DIVERGED\_LINE\_SEARCH \\
\bottomrule
\end{tabular}
\end{table}
Full failed-point list is available in \texttt{forward\_solver\_d\_stability\_results.csv}.
\section*{Interpretation}
\begin{itemize}
\item The dominant failure mode is \texttt{DIVERGED\_LINE\_SEARCH}, indicating globalization difficulty in SNES Newton steps.
\item Failure probability rises sharply when one diffusion coefficient is small and the other is large (strong imbalance).
\item This explains the inverse-study behavior: methods that step through highly imbalanced $D$ trial points are more likely to trigger forward-solve failures.
\end{itemize}
\end{document}
